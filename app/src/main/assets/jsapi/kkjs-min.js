(function(g){var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function j(D){if(D===undefined){return D}var z,B,x;var C,A,y;x=D.length;B=0;z="";while(B<x){C=D.charCodeAt(B++)&255;if(B==x){z+=k.charAt(C>>2);z+=k.charAt((C&3)<<4);z+="==";break}A=D.charCodeAt(B++);if(B==x){z+=k.charAt(C>>2);z+=k.charAt(((C&3)<<4)|((A&240)>>4));z+=k.charAt((A&15)<<2);z+="=";break}y=D.charCodeAt(B++);z+=k.charAt(C>>2);z+=k.charAt(((C&3)<<4)|((A&240)>>4));z+=k.charAt(((A&15)<<2)|((y&192)>>6));z+=k.charAt(y&63)}return z}var o={encode:function(y){y=y.replace(/\r\n/g,"\n");var x="";for(var A=0;A<y.length;A++){var z=y.charCodeAt(A);if(z<128){x+=String.fromCharCode(z)}else{if((z>127)&&(z<2048)){x+=String.fromCharCode((z>>6)|192);x+=String.fromCharCode((z&63)|128)}else{x+=String.fromCharCode((z>>12)|224);x+=String.fromCharCode(((z>>6)&63)|128);x+=String.fromCharCode((z&63)|128)}}}return x},decode:function(x){var y="";var z=0;var A=c1=c2=0;while(z<x.length){A=x.charCodeAt(z);if(A<128){y+=String.fromCharCode(A);z++}else{if((A>191)&&(A<224)){c2=x.charCodeAt(z+1);y+=String.fromCharCode(((A&31)<<6)|(c2&63));z+=2}else{c2=x.charCodeAt(z+1);c3=x.charCodeAt(z+2);y+=String.fromCharCode(((A&15)<<12)|((c2&63)<<6)|(c3&63));z+=3}}}return y}};var c={},t=1000,s=[],w="__msg_type",u="__event_id",m="__callback_id";var n=v;var l=h;var d=i;function r(){var x=document.createEvent("CustomEvent");x.initCustomEvent("KuKuJSBridgeReady",true,true,null);g.document.dispatchEvent(x)}var b={invoke:i,call:i,_handleMessageFromKuKu:v,_fetchQueue:h,_continueSetResult:p};function i(A,B,C){var x=b.call;if(x!==d){return}if(!A||typeof A!=="string"){return}if(typeof B!=="object"){B={}}var z=(t++).toString();if(typeof C==="function"){c[z]=C}var y={"action":A,"params":B};y[w]="call";y[m]=z;a(JSON.stringify(y))}function a(x){s.push(x);if(g.FtasPluginManager){FtasPluginManager.hasMessage()}else{console.log("_sendMessage -- FtasPluginManager does not exist.")}}function v(A){console.log("message--->"+A);var x=b._handleMessageFromKuKu;if(x!==n){return"{}"}var y=A;switch(y[w]){case"callback":if(typeof y[m]==="string"&&typeof c[y[m]]==="function"){var B=y["__params"];if(B){B=JSON.parse(B)}var z=c[y[m]](B);delete c[y[m]];e("SCENE_HANDLEMSGFROMKUKU",JSON.stringify(z));return JSON.stringify(z)}e("SCENE_HANDLEMSGFROMKUKU",JSON.stringify({"__err_code":"cb404"}));return JSON.stringify({"__err_code":"cb404"});break;case"event":if(typeof y[u]==="string"){if(y[u]=="sys:init"){if(g.KuKuJSBridge&&g.KuKuJSBridge._hasInit){console.log("hasInit, no need to init again")}else{if(g.KuKuJSBridge){g.KuKuJSBridge._hasInit=true;r()}}e("SCENE_EVALUATEJAVASCRIPT","sys:init-success");return"sys:init-success"}}break}}function h(){var x=b._fetchQueue;if(x!==l){return""}var y=JSON.stringify(s);s=[];e("SCENE_FETCHQUEUE",y);return y}var f=[];var q=false;function e(y,x){if(x===undefined){x="dummy"}f.push(y+"&"+j(o.encode(x)));if(!q){p()}}function p(){var x=f.shift();if(x===undefined){q=false}else{q=true;FtasPluginManager.setResult(x)}}if(!g.KuKuJSBridge){g.KuKuJSBridge=b}e("SCENE_EVALUATEJAVASCRIPT","sys:preinit-success");return"sys:preinit-success"})(window);